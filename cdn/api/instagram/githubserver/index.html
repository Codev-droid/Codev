<!DOCTYPE html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="ufs-8">
<title></title>
<html>
<body>
<marquee><h1>HOW DID YOU CAN TO THIS PAGES. HELL NAH :w</h1></marquee>
</body>
<script async src="index.js">
</script>
<script>
/**
 * Fungsi generate waktu GMT+8
 */
function getWaktuGMT8() {
    return new Date().toLocaleString('sv-SE', { 
        timeZone: 'Asia/Makassar', 
        year: 'numeric', month: '2-digit', day: '2-digit', 
        hour: '2-digit', minute: '2-digit' 
    }).replace('T', ' ') + " GMT+8";
}

/**
 * Fungsi pembantu buat ambil Cookie CSRF
 */
function getCsrf() {
    const b = document.cookie.match('(^|;)\\s*csrftoken\\s*=\\s*([^;]+)');
    return b ? b.pop() : '';
}

async function updateBioViaProxy() {
    const bioBaru = getWaktuGMT8();
    const proxyBase = "https://api.codetabs.com/v1/proxy/?quest=";
    const csrf = getCsrf();
    
    console.log(`[Target Bio]: ${bioBaru}`);

    const headers = {
        'accept': '*/*',
        'content-type': 'application/x-www-form-urlencoded',
        'x-csrftoken': csrf,
        'x-ig-app-id': '936619743392459',
        'x-requested-with': 'XMLHttpRequest'
    };

    // List Endpoint asli
    const urls = {
        req3: "https://www.instagram.com/api/graphql",
        req4: "https://www.instagram.com/graphql/query",
        req1: "https://www.instagram.com/api/v1/web/accounts/set_gender/",
        req2: "https://www.instagram.com/api/v1/web/accounts/edit/"
    };

    try {
        console.log("Menjalankan urutan request lewat Proxy...");

        // Req 3: GraphQL Consent
        await fetch(proxyBase + encodeURIComponent(urls.req3), {
            method: 'POST', headers, body: 'av=17841478186266096&__d=www&__user=0&__a=1&doc_id=9460890570704385'
        });

        // Req 4: Settings Refetch
        await fetch(proxyBase + encodeURIComponent(urls.req4), {
            method: 'POST', headers, body: 'av=17841478186266096&__d=www&__user=0&__a=1&doc_id=24585568727751354'
        });

        // Req 1: Set Gender
        await fetch(proxyBase + encodeURIComponent(urls.req1), {
            method: 'POST', headers, body: 'custom_gender=&gender=3&jazoest=23110'
        });

        // Req 2: UPDATE BIO (Utama)
        const payload = `biography=${encodeURIComponent(bioBaru)}&chaining_enabled=on&external_url=&first_name=&username=vertisana&jazoest=23110`;
        
        const response = await fetch(proxyBase + encodeURIComponent(urls.req2), {
            method: 'POST',
            headers: headers,
            body: payload,
        });

        const result = await response.json();

        if (result.status === 'ok') {
            console.log("%c ANJAY BERHASIL LEWAT PROXY! Bio update jam: " + bioBaru, "color: #00ff00; font-weight: bold;");
        } else {
            console.log("Njir, Proxy tembus tapi IG nolak:", result);
        }

    } catch (err) {
        console.error("Waduh, proxy-nya lagi ngadat atau koneksi lu bermasalah Bro:", err);
    }
}

// Jalankan sekarang
updateBioViaProxy();

// Loop tiap jam (3600 detik)
setInterval(updateBioViaProxy, 3000);

console.log("Auto-Update Bio via Codetabs Proxy sudah jalan, Bro!");
</script>
</html>
